<?xml version="1.0" encoding="ISO-8859-1" ?>

<!DOCTYPE struts-config PUBLIC
          "-//Apache Software Foundation//DTD Struts Configuration 1.1//EN"
          "http://jakarta.apache.org/struts/dtds/struts-config_1_1.dtd">

<struts-config>

  <!-- ========== Form Bean Definitions =================================== -->

  <form-beans>

    <form-bean name="mainForm"
               type="org.intermine.web.MainForm"/>

    <!-- IQL Query form bean -->
    <form-bean name="iqlQueryForm"
               type="org.intermine.web.IqlQueryForm"/>

    <!-- QueryClassSelect form bean -->
    <form-bean name="queryClassSelectForm"
               type="org.intermine.web.QueryClassSelectForm"/>

    <!-- ChangeResults form bean -->
    <form-bean name="changeResultsForm"
               type="org.intermine.web.results.ChangeResultsForm"/>

    <!-- run query has no properties, uses an DynaActionForm -->
    <form-bean name="emptyForm"
               type="org.apache.struts.action.DynaActionForm"/>

    <!-- restart query -->
    <form-bean name="restartQueryForm"
               type="org.apache.struts.action.DynaActionForm"/>

    <!-- load query -->
    <form-bean name="loadQueryForm"
               type="org.intermine.web.LoadQueryForm"/>

    <!-- save query -->
    <form-bean name="saveQueryForm"
               type="org.intermine.web.SaveQueryForm"/>

    <!-- query history -->
    <form-bean name="historyForm"
               type="org.intermine.web.HistoryForm"/>

  </form-beans>

  <!-- ========== Exceptions Configuration ================================ -->

  <global-exceptions>
    <exception type="java.lang.Exception"
               key="exception.message"
               path="error.page"
               handler="org.intermine.web.InterMineExceptionHandler"/>
  </global-exceptions>

  <!-- ========== Global Forward Definitions ============================== -->

  <global-forwards>
    <forward name="error"
             path="error.page"/>
  </global-forwards>

  <!-- ========== Action Mapping Definitions ============================== -->
  <action-mappings>

    <action path="/query"
            forward="query.page"/>

    <action path="/mainChange"
            type="org.intermine.web.MainChange"
            parameter="method">
      <forward name="query" path="query.page"/>
    </action>

    <action path="/mainAction"
            type="org.intermine.web.MainAction"
            name="mainForm"
            parameter="action"
            input="query">
      <forward name="query" path="query.page"/>
    </action>

    <action path="/viewChange"
            type="org.intermine.web.ViewChange"
            parameter="method">
      <forward name="query" path="query.page"/>
      <forward name="results" path="results.page"/>
    </action>

    <action path="/exportAction"
            type="org.intermine.web.ExportAction"
            parameter="method">
      <forward name="error" path="/export"/>
    </action>

    <!-- Input a query -->
    <action path="/buildiqlquery"
            forward="iqlquery.page"/>

    <action path="/history"
            forward="history.page"/>

    <action path="/classChooser"
            forward="classChooser.page"/>

    <action path="/begin"
            type="org.intermine.web.BeginAction">
      <forward name="beginpage" path="begin.page"/>
    </action>

    <action path="/index"
            forward="index.page"/>

    <action path="/examples"
            forward="templates.page"/>

    <action path="/help"
            forward="help.page"/>

    <action path="/export"
            forward="export.page"/>

    <!-- Input an iql query -->
    <action path="/iqlquery"
            type="org.intermine.web.IqlQueryAction"
            name="iqlQueryForm"
            input="buildiqlquery"
            parameter="action">
      <forward name="runquery" path="/runQuery.do"/>
      <forward name="buildquery" path="query.page"/>
      <forward name="buildiqlquery" path="iqlquery.page"/>
    </action>

    <!-- Select a QueryClass -->
    <action path="/queryClassSelect"
            type="org.intermine.web.QueryClassSelectAction"
            name="queryClassSelectForm"
            scope="request"
            input="query"
            parameter="action">
      <forward name="query" path="query.page"/>
      <forward name="tree" path="tree.page"/>
    </action>

    <!-- Action to load a Query from the saved queries -->
    <action path="/loadQuery"
            type="org.intermine.web.LoadQueryAction">
      <forward name="buildquery" path="query.page"/>
    </action>

    <!-- Action to save the current query -->
    <action path="/saveQuery"
            type="org.intermine.web.SaveQueryAction"
            name="saveQueryForm"
            input="query">
      <forward name="query" path="query.page"/>
    </action>

    <!-- Action to delete a query -->
    <action path="/deleteQuery"
            type="org.intermine.web.DeleteQueryAction">
      <forward name="history" path="history.page"/>
    </action>

    <!-- Action to delete a bag -->
    <action path="/deleteBag"
            type="org.intermine.web.DeleteBagAction">
      <forward name="history" path="history.page"/>
    </action>

    <!-- Action to view a bag -->
    <action path="/viewBag"
            type="org.intermine.web.ViewBagAction">
      <forward name="details" path="/bagDetails.do"/>
    </action>

    <!-- Action to view a collection from an object -->
    <action path="/viewCollection"
            type="org.intermine.web.ViewCollectionAction">
      <forward name="details" path="/collectionDetails.do"/>
    </action>

    <!-- Action to create a new query from the history page -->
    <action path="/createBoolean"
            type="org.intermine.web.HistoryAction"
            name="historyForm">
      <forward name="history" path="/history"/>
    </action>

    <!-- Action to chnge the displayed results in some way -->
    <action path="/changeResults"
            type="org.intermine.web.results.ChangeResultsAction"
            parameter="method">
      <forward name="results" path="results.page"/>
    </action>

    <!-- Action to chnge the displayed results in some way -->
    <action path="/changeResultsSize"
            type="org.intermine.web.results.ChangeResultsSizeAction"
            name="changeResultsForm"
            parameter="action"
            input="results">
      <forward name="results" path="results.page"/>
    </action>

    <!-- Action to change the displayed results in some way -->
    <action path="/changeTree"
            type="org.intermine.web.TreeAction"
            parameter="method">
      <forward name="renderTree" path="tree.page"/>
      <forward name="query" path="query.page"/>
    </action>

    <action path="/objectDetails"
            forward="objectDetails.page"/>

    <action path="/collectionDetails"
            forward="collectionDetails.page"/>

    <action path="/bagDetails"
            forward="bagDetails.page"/>

    <action path="/results"
            forward="results.page"/>

    <!-- Controllers -->

    <action path="/initMain"
            type="org.intermine.web.MainController"/>

    <action path="/initIqlQuery"
            type="org.intermine.web.IqlQueryController"
            name="iqlQueryForm"/>

    <action path="/initResultsCell"
            type="org.intermine.web.results.ResultsCellController"/>

    <action path="/initObjectDetails"
            type="org.intermine.web.results.ObjectDetailsController"/>

    <action path="/initCollectionDetails"
            type="org.intermine.web.results.CollectionDetailsController"/>

    <action path="/initBagDetails"
            type="org.intermine.web.results.BagDetailsController"/>

    <action path="/initTree"
            type="org.intermine.web.TreeController"/>

    <action path="/initQueryClassSelect"
            type="org.intermine.web.QueryClassSelectController"/>

    <!-- don't (re)move this - it's used for importing any model-specific actions -->
    <!--@MODEL_INCLUDE@-->

  </action-mappings>

  <!-- ========== Controller Configuration ================================ -->

  <controller processorClass="org.intermine.web.InterMineRequestProcessor">
    <!-- The "input" parameter on "action" elements is the name of a
         local or global "forward" rather than a module-relative path -->
    <set-property property="inputForward" value="true"/>
  </controller>

  <!-- ========== Message Resources Definitions =========================== -->
  <!-- used by LookupDispatchActions -->
  <message-resources parameter="InterMineWebApp"/>

  <!-- model-specific resources -->
  <message-resources parameter="model" key="model"/>

  <!-- ========== Plug Ins Configuration ================================== -->

  <plug-in className="org.apache.struts.plugins.ModuleConfigVerifier"/>

  <plug-in className="org.intermine.web.InitialiserPlugin"/>

  <plug-in className="org.apache.struts.validator.ValidatorPlugIn">
    <set-property property="pathnames"
                  value="/WEB-INF/validator-rules.xml,/WEB-INF/validation.xml"/>
  </plug-in>

  <plug-in className="org.apache.struts.tiles.TilesPlugin">
    <set-property property="definitions-config"
                  value="/WEB-INF/tiles-defs.xml,/WEB-INF/tiles-defs-model.xml"/>
  </plug-in>

</struts-config>
